<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - ShopEasy</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="container">
                <div class="nav-brand">
                    <h1>ShopEasy</h1>
                </div>
                <ul class="nav-menu">
                    <li><a href="../index.html">Home</a></li>
                    <li><a href="products.html">Products</a></li>
                    <li><a href="cart.html">Cart <span id="cart-count">0</span></a></li>
                    <li><a href="checkout.html" class="active">Checkout</a></li>
                </ul>
            </div>
        </nav>
    </header>

    <main>
        <div class="checkout-container">
            <h2 class="section-title">Checkout</h2>
            
            <div id="checkout-content">
                <div class="empty-cart">
                    <h2>Your cart is empty</h2>
                    <p>Add some items to your cart before checkout!</p>
                    <a href="products.html" class="btn-primary" style="margin-top: 1rem; display: inline-block;">
                        Browse Products
                    </a>
                </div>
            </div>

            <div class="checkout-form" id="checkout-form" style="display: none;">
                <h3 style="margin-bottom: 1.5rem;">Shipping Information</h3>
                <form id="checkout-form-element" onsubmit="handleCheckout(event)">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="firstName">First Name</label>
                            <input type="text" id="firstName" name="firstName" required>
                        </div>
                        <div class="form-group">
                            <label for="lastName">Last Name</label>
                            <input type="text" id="lastName" name="lastName" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="phone">Phone</label>
                        <input type="tel" id="phone" name="phone" required>
                    </div>
                    <div class="form-group">
                        <label for="address">Address</label>
                        <input type="text" id="address" name="address" required>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="city">City</label>
                            <input type="text" id="city" name="city" required>
                        </div>
                        <div class="form-group">
                            <label for="zip">ZIP Code</label>
                            <input type="text" id="zip" name="zip" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="country">Country</label>
                        <select id="country" name="country" required>
                            <option value="">Select Country</option>
                            <option value="USA">United States</option>
                            <option value="UK">United Kingdom</option>
                            <option value="Canada">Canada</option>
                            <option value="India">India</option>
                            <option value="Australia">Australia</option>
                        </select>
                    </div>
                    
                    <h3 style="margin: 2rem 0 1.5rem 0;">Payment Information</h3>
                    <div class="form-group">
                        <label for="cardNumber">Card Number</label>
                        <input type="text" id="cardNumber" name="cardNumber" placeholder="1234 5678 9012 3456" maxlength="19" required>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="expiry">Expiry Date</label>
                            <input type="text" id="expiry" name="expiry" placeholder="MM/YY" maxlength="5" required>
                        </div>
                        <div class="form-group">
                            <label for="cvv">CVV</label>
                            <input type="text" id="cvv" name="cvv" placeholder="123" maxlength="3" required>
                        </div>
                    </div>
                    
                    <div class="cart-summary" style="margin-top: 2rem;">
                        <div class="cart-total">
                            Order Total: $<span id="order-total">0.00</span>
                        </div>
                        <button type="submit" class="btn-primary" style="width: 100%; margin-top: 1rem; padding: 15px; font-size: 1.1rem;">
                            Complete Order
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 ShopEasy. All rights reserved.</p>
        </div>
    </footer>

    <script src="../js/cart.js"></script>
    <script>
        function formatCardNumber(value) {
            const v = value.replace(/\s+/g, '').replace(/[^0-9]/gi, '');
            const matches = v.match(/\d{4,16}/g);
            const match = matches && matches[0] || '';
            const parts = [];
            for (let i = 0, len = match.length; i < len; i += 4) {
                parts.push(match.substring(i, i + 4));
            }
            if (parts.length) {
                return parts.join(' ');
            } else {
                return v;
            }
        }

        function formatExpiry(value) {
            const v = value.replace(/\s+/g, '').replace(/[^0-9]/gi, '');
            if (v.length >= 2) {
                return v.substring(0, 2) + '/' + v.substring(2, 4);
            }
            return v;
        }

        document.getElementById('cardNumber')?.addEventListener('input', function(e) {
            e.target.value = formatCardNumber(e.target.value);
        });

        document.getElementById('expiry')?.addEventListener('input', function(e) {
            e.target.value = formatExpiry(e.target.value);
        });

        document.getElementById('cvv')?.addEventListener('input', function(e) {
            e.target.value = e.target.value.replace(/[^0-9]/g, '');
        });

        function handleCheckout(event) {
            event.preventDefault();
            if (cart.items.length === 0) {
                alert('Your cart is empty!');
                return;
            }
            
            alert('Order placed successfully! Thank you for your purchase.');
            cart.clearCart();
            window.location.href = '../index.html';
        }

        document.addEventListener('DOMContentLoaded', function() {
            cart.updateCartCount();
            
            if (cart.items.length === 0) {
                document.getElementById('checkout-content').style.display = 'block';
                document.getElementById('checkout-form').style.display = 'none';
            } else {
                document.getElementById('checkout-content').style.display = 'none';
                document.getElementById('checkout-form').style.display = 'block';
                document.getElementById('order-total').textContent = cart.getTotal().toFixed(2);
            }
        });
    </script>
</body>
</html>

