<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Products - ShopEasy</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="container">
                <div class="nav-brand">
                    <h1>ShopEasy</h1>
                </div>
                <ul class="nav-menu">
                    <li><a href="../index.html">Home</a></li>
                    <li><a href="products.html" class="active">Products</a></li>
                    <li><a href="cart.html">Cart <span id="cart-count">0</span></a></li>
                    <li><a href="checkout.html">Checkout</a></li>
                </ul>
            </div>
        </nav>
    </header>

    <main>
        <section class="products-page">
            <div class="container">
                <h2 class="section-title">All Products</h2>
                
                <div class="products-page-content">
                    <aside class="filters-sidebar">
                        <div class="filter-section">
                            <h3>Categories</h3>
                            <div class="category-buttons">
                                <button class="category-btn active" data-category="all">All Products</button>
                                <button class="category-btn" data-category="electronics">Electronics</button>
                                <button class="category-btn" data-category="clothing">Clothing</button>
                                <button class="category-btn" data-category="accessories">Accessories</button>
                            </div>
                        </div>
                        
                        <div class="filter-section">
                            <h3>Price Range</h3>
                            <div class="price-filter">
                                <div class="price-input-group">
                                    <label for="min-price">Min Price: $<span id="min-price-display">0</span></label>
                                    <input type="range" id="min-price" min="0" max="300" value="0" step="10">
                                </div>
                                <div class="price-input-group">
                                    <label for="max-price">Max Price: $<span id="max-price-display">300</span></label>
                                    <input type="range" id="max-price" min="0" max="300" value="300" step="10">
                                </div>
                                <button class="btn-filter" onclick="applyFilters()">Apply Filters</button>
                                <button class="btn-filter btn-clear" onclick="clearFilters()">Clear Filters</button>
                            </div>
                        </div>
                    </aside>
                    
                    <div class="products-main">
                        <div class="products-header">
                            <p class="results-count">Showing <span id="results-count">0</span> products</p>
                        </div>
                        <div class="products-grid" id="all-products">
                            <!-- Products will be loaded here by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 ShopEasy. All rights reserved.</p>
        </div>
    </footer>

    <script src="../js/cart.js"></script>
    <script src="../js/products.js"></script>
    <script>
        let currentCategory = 'all';
        let currentMinPrice = 0;
        let currentMaxPrice = 300;
        
        function updatePriceDisplay() {
            document.getElementById('min-price-display').textContent = document.getElementById('min-price').value;
            document.getElementById('max-price-display').textContent = document.getElementById('max-price').value;
        }
        
        function applyFilters() {
            currentMinPrice = parseInt(document.getElementById('min-price').value);
            currentMaxPrice = parseInt(document.getElementById('max-price').value);
            filterAndDisplayProducts();
        }
        
        function clearFilters() {
            currentCategory = 'all';
            currentMinPrice = 0;
            currentMaxPrice = 300;
            
            document.getElementById('min-price').value = 0;
            document.getElementById('max-price').value = 300;
            updatePriceDisplay();
            
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector('[data-category="all"]').classList.add('active');
            
            filterAndDisplayProducts();
        }
        
        function filterAndDisplayProducts() {
            let filteredProducts = getProductsByCategory(currentCategory);
            filteredProducts = filterProductsByPrice(filteredProducts, currentMinPrice, currentMaxPrice);
            
            displayProducts('all-products', filteredProducts);
            document.getElementById('results-count').textContent = filteredProducts.length;
        }
        
        function initializeCategory() {
            const urlParams = new URLSearchParams(window.location.search);
            const categoryParam = urlParams.get('category');
            
            if (categoryParam) {
                currentCategory = categoryParam;
                document.querySelectorAll('.category-btn').forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.getAttribute('data-category') === categoryParam) {
                        btn.classList.add('active');
                    }
                });
            }
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            cart.updateCartCount();
            
            initializeCategory();
            
            document.getElementById('min-price').addEventListener('input', updatePriceDisplay);
            document.getElementById('max-price').addEventListener('input', updatePriceDisplay);
            
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentCategory = this.getAttribute('data-category');
                    filterAndDisplayProducts();
                });
            });
            
            filterAndDisplayProducts();
        });
    </script>
</body>
</html>
